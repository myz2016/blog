# 线程安全

## 什么是线程安全

### Brian Goetz 的定义

《Java Concurrency In Practice》的作者 Brian Goetz 对“线程安全”有一个比较恰当的定义：“当多个线程访问一个对象时，如果<font color=red>**不用考虑**</font>这些线程在运行时环境下的调度和交替执行，<font color=red>**也不需要进行额外的同步**</font>，或者在调用方进行任何其他的协调操作，调用这个对象的行为都可以获得<font color=red>**正确的结果**</font>，那这个对象就是线程安全的。”

### 悟空的定义

不管业务中遇到怎样的多个线程访问某个对象或某方法的情况，而在编程这个业务逻辑的时候，<font color=red>**都不需要额外做任何额外的处理**</font>（也就是可以像单线程编程一样），程序也可以正常运行（不会因为多线程而出错），就可以称为线程安全。

* 线程不安全
  * get 同时 set，额外同步，这些表现都说明线程是不安全的，如果线程安全就不需要额外的同步了
* 全都线程安全
  * 全部都设计成线程安全的，那么程序的运行速度会受到影响，而且设计成本会增高
* 完全不用于多线程
  * 如果一个类在设计的时候就能知道，它完全不会用于多线程，那么就不需要考虑线程安全问题，不要过度设计

## 什么情况下会出现线程安全问题，怎么避免？

### 运行结果错误：a++ 多线程下出现消失的请求现象